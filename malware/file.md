# Determining A File's Type

As malware analysts we are often presented with files of unknown, well, provenance. Those files arrive at our doorstep and the courier provides us with no metadata, information about the information.

What's worse than that situation is the possibility that an attacker has intentionally modified the metadata of a file to throw us off the scent. In a simple case, consider a person who used a `.pdf` extension on a `.exe` in order to trick us into double clicking.

We need a tool that is able to look into the contents of a file of unknown provenance, examine the format of the file's data, and report back on the type of that file.

If you thought the word *file* was used too much in the previous three paragraphs then it won't surprise you to find out that the tool we use to accomplish such a task is called `file`.

## Terminal

`file` is a command-line utility, so the first thing that you will need to do to use it is to open an instance of the *Terminal Emulator*. 

> Note: I will assume that you have the example files at the ready and are familiar with `cd`ing to the proper directory where those files exist. If you want more information on that process, read Interstitial and Get Situated in the [`hexdump` SAID](./hexdump.md).

## I Can See Your True Colors

Using `file` effectively is straightforward: the file(s) to inspect are given as arguments to the command. For example, to have `file` determine the type of a file named `/bin/ls`, simply execute

```console
$ file /bin/ls
/bin/ls: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=15dfff3239aa7c3b16a71e6b2e3b6e4009dab998, for GNU/Linux 3.2.0, stripped
```

The interpretation of the output of `file` depends on the type of the file and is not covered here. 

The output from `file` for `/bin/ls` demonstrates the first of three ways that `file` determines a file's type: by consulting well-known system information about *special* files (i.e., executables, device sockets, etc.). 

If a file is not identifiable by those criteria, then `file` consults its database of *magic numbers* to inspect the file. These magic numbers describe sets of bytes that appear at a certain place in a file that identify it as a particular type of file. For instance, 

```console
$ file example.pdf
example.pdf: PDF document, version 1.4, 1 pages (zip deflate encoded)
```

Finally, if `file` cannot make heads or tails of the file to this point, it simply looks to determine whether the file contains text and, if it does, attempts to determine the language of that text. Consider,

```console
$ file simple.txt
files/simple.txt: ASCII text, with very long lines (981)
```

> Note: You can use globs to create the argument list for `file` in the same way that globs can be used to specify the files to [hash](./hashes.md).
# Say As I Do

1. Determine the type of the `example.png` file.
1. Determine the type of `mystery.file`.

[Answer](./file-ans.md)
