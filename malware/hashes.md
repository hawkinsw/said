# Hashes

[One-way hash functions](https://en.wikipedia.org/wiki/Cryptographic_hash_function) have many useful properties. In combination, those properties make one-way hash functions useful tools for creating *digital signatures* for files. Malware analysts use these digital signatures as inputs to online virus databases (e.g., [VirusTotal](https://www.virustotal.com/)) to determine whether a given file is malicious or not. 

There are myriad tools in Linux that will let you compute the digital signature of a file -- they all follow roughly the same naming convention:

*`XXX`*`sum`

where `XXX` is the name of the one-way hash function.

It is vital that, as malware analysts, you know how to create digital signatures for files.

In this Say As I Do, we will use `md5sum`, `sha128sum`, `sha256sum` and `sha512sum` to calculate the digital signatures of files.

> Note: If you would like to read more about the underlying one-way hash functions used by these tools (and the properties of one-way hash functions in general), take a look at Chapter 6 of [Serious Cryptography](https://learning.oreilly.com/library/view/serious-cryptography/9781492067511/) (accessible for free through the library!).

## Terminal

The tools we will work with today are all command-line utilities, so the first thing that you will need to do is to open an instance of the *Terminal Emulator*. 

> Note: I will assume that you have the example files at the ready and are familiar with `cd`ing to the proper directory where those files exist. If you want more information on that process, read Interstitial and Get Situated in the [`hexdump` SAID](./hexdump.md).

## Mirror, Mirror, Who's The Weakest Of Them All?

Let's start by calculating the digital signature of a file using the MD5 one-way hash function as implemented by the `md5sum` command-line tool. 

```console
$ md5sum example.pdf
2942bfabb3d05332b66eb128e0842cff  example.pdf 
```

Short, sweet, and to the point! The string to the left of the space are the bytes of the digital signature. The MD5 one-way hash function produces a hash value that is 128 bits long (or 16 bytes). So, the digital signature produced by `md5sum` should have 32 hexadecimal digits. Let's count 'em up:

1. `2`
2. `9`
3. `4`

Just kidding, we won't do them all. But, you should verify that there are 32 hexadecimal digits in the output! It's a good theory-meets-practice gut check.

## SHA, There It Is

The MD5 algorithm was invented by the famed cryptographer [Ron Rivest](https://en.wikipedia.org/wiki/Ron_Rivest) and MD stands for *m*essage *d*igest. 

The name for the SHA family of one-way hash functions comes from the acronym for [Secure Hash Algorithms](https://en.wikipedia.org/wiki/Secure_Hash_Algorithms). There are many different versions and *strengths* (256 bit, 128 bit, etc) of one-way hash functions in this family. `sha256sum` and `sha512sum` are the names of the command-line tools that we can use to calculate digital signatures based on the respective SHA one-way hash function:

```console
$ sha256sum example.pdf
3df79d34abbca99308e79cb94461c1893582604d68329a41fd4bec1885e6adb4  example.pdf
```

The output format is the same as the format for the `md5sum` command-line tool. Pretty cool! (Wow, a rhyme!)

Now, let's do 512:

```console
$ sha512sum example.pdf
f3b3ab3e6351e25b5c1882bea8d37efaddc0ea72bf153bb067688f775a26810d32b54f014bf1cebc7fe93042d85b18b5b453e322d154bc55d5cc2754b0dfb4b2  example.pdf
```

# Say As I Do

1. Calculate the `sha256sum` of the `example.bin` file.
1. Determine whether `mystery.file` is a copy of `example.bin`, `example.pdf` or `example.png`.
1. Calculate the number of bytes needed to represent a digital signature computed using the `sha512sum` command-line tool.

[Answer](./hashes-ans.md)